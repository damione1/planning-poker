<!DOCTYPE html>
<html lang="en" class="dark">

<head>
	<title>Chat | DeploySolo</title>
	{{ template "head" . }}
</head>

<body hx-boost="true">
	<div class="container-fluid">
		<div class="row">

			{{ template "dash" dict "Selected" "chat" }}

			<div class="col h-100 overflow-auto">
				<div class="container p-4">
					<div class="row flex-grow-1 overflow-auto">
						<div class="col-12">
							<div id="chat-container" class="d-flex flex-column">
								<div class="assistant-chat-message align-self-start bg-white text-dark border rounded p-2 mb-2 shadow-sm"
									style="max-width: 70%;">
									Hello! How can I help you with DeploySolo?
								</div>

								<!-- Conversation -->

							</div>
						</div>
					</div>
					<div id="spinner" class="htmx-indicator">
						<div class="spinner-border text-primary" role="status">
							<span class="visually-hidden">Loading...</span>
						</div>
					</div>
					<div class="row my-3">
						<div class="col-12">
							<form id="chat-form" hx-post="/app/chat" hx-target="#chat-container" hx-swap="beforeend"
								hx-trigger="submit" hx-indicator="#spinner" hx-include="#chat-include">
								<div class="input-group">
									<input name="user-message" id="user-message" type="text" class="form-control"
										placeholder="Type your message...">
									<input type="hidden" name="chat-include" id="chat-include">
									<button class="btn btn-primary" type="submit">Send</button>
								</div>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<script>
		document.getElementById('chat-form').addEventListener('submit', function (event) {
			const inputField = document.getElementById('user-message');
			const userMessage = inputField.value.trim();

			if (userMessage === '') {
				event.preventDefault();
				return;
			}
			var chatContainer = document.getElementById('chat-container');
			chatContainer.innerHTML += `
				<div class="user-chat-message align-self-end bg-primary text-white border rounded p-2 mb-2 shadow-sm"
					style="max-width: 70%;">
					${userMessage}
				</div>`;

			var chatInclude = document.getElementById('chat-include');
			chatInclude.value = chatContainer.innerHTML;
			inputField.value = '';
		});
	</script>

	{{ template "cornercolorswitcher" . }}
	{{ template "footscripts" . }}

</body>

</html>
